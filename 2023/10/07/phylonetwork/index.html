<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error | TianzhenWu' Blog</title><meta name="author" content="吴 田 振"><meta name="copyright" content="吴 田 振"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错该软件的详细说明请参考他的官方网站Home · PhyloNetworks.jl (crsl4.github.io)，该软件的中文流程（包括简介、安装使用流程等）请参考系统发育网络推断 —— PhyloNetworks | 生信技工 (yanzhongsino.github.io)，本笔记参考以上两个站点并测试无报错。 1、安">
<meta property="og:type" content="article">
<meta property="og:title" content="系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error">
<meta property="og:url" content="https://wu-tz.github.io/2023/10/07/phylonetwork/index.html">
<meta property="og:site_name" content="TianzhenWu&#39; Blog">
<meta property="og:description" content="一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错该软件的详细说明请参考他的官方网站Home · PhyloNetworks.jl (crsl4.github.io)，该软件的中文流程（包括简介、安装使用流程等）请参考系统发育网络推断 —— PhyloNetworks | 生信技工 (yanzhongsino.github.io)，本笔记参考以上两个站点并测试无报错。 1、安">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wu-tz.github.io/2023/10/07/phylonetwork/1.png">
<meta property="article:published_time" content="2023-10-07T08:07:46.000Z">
<meta property="article:modified_time" content="2024-05-29T04:43:18.852Z">
<meta property="article:author" content="吴 田 振">
<meta property="article:tag" content="PhyloNetworks">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wu-tz.github.io/2023/10/07/phylonetwork/1.png"><link rel="shortcut icon" href="/img/w-833386_640.png"><link rel="canonical" href="https://wu-tz.github.io/2023/10/07/phylonetwork/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-29 12:43:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/orca-295051_1280.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/2023/10/07/phylonetwork/1.png')"><nav id="nav"><span id="blog-info"><a href="/" title="TianzhenWu' Blog"><img class="site-icon" src="/img/w-833386_640.png"/><span class="site-name">TianzhenWu' Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-07T08:07:46.000Z" title="发表于 2023-10-07 16:07:46">2023-10-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-29T04:43:18.852Z" title="更新于 2024-05-29 12:43:18">2024-05-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%8A%B6%E8%BF%9B%E5%8C%96/">网状进化</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h5 id="一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错"><a href="#一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错" class="headerlink" title="一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错"></a>一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错</h5><p>该软件的详细说明请参考他的官方网站<a target="_blank" rel="noopener" href="http://crsl4.github.io/PhyloNetworks.jl/latest/">Home · PhyloNetworks.jl (crsl4.github.io)</a>，该软件的中文流程（包括简介、安装使用流程等）请参考<a target="_blank" rel="noopener" href="https://yanzhongsino.github.io/2022/04/14/bioinfo_geneflow_PhyloNetworks/">系统发育网络推断 —— PhyloNetworks | 生信技工 (yanzhongsino.github.io)</a>，本笔记参考以上两个站点并测试无报错。</p>
<h5 id="1、安装"><a href="#1、安装" class="headerlink" title="1、安装"></a>1、安装</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget https://julialang-s3.julialang.org/bin/linux/x64/1.7/julia-1.7.2-linux-x86_64.tar.gz <span class="comment">#下载</span></span><br><span class="line">tar -xzf julia-1.7.2-linux-x86_64.tar.gz <span class="comment">#解压</span></span><br><span class="line">julia-1.7.2/bin/julia -h <span class="comment">#若无报错则安装julia成功</span></span><br><span class="line"></span><br><span class="line">julia-1.7.2/bin/julia  <span class="comment">#进入julia运行界面，类似于python和r的交互模式</span></span><br><span class="line">julia&gt; using Pkg <span class="comment">#类似于r的library和python的import来加载函数</span></span><br><span class="line">julia&gt; Pkg.add(<span class="string">&quot;PhyloNetworks&quot;</span>) <span class="comment">#安装PhyloNetworks</span></span><br><span class="line">julia&gt; Pkg.add(<span class="string">&quot;PhyloPlots&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>在安装过程中遇到以下报错</strong></p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: Unable to automatically install &#x27;Bzip2&#x27; from &#x27;/home/manu/.julia/packages/Bzip2_jll/<span class="number">2</span>H8pU/Artifacts.toml</span><br></pre></td></tr></table></figure>

<p>参考github的论坛<a target="_blank" rel="noopener" href="https://github.com/JuliaLang/Pkg.jl/issues/1705">ERROR: Unable to automatically install  Artifacts.toml issue? · Issue #1705 · JuliaLang&#x2F;Pkg.jl (github.com)</a>，以下这个解决方法对我的报错有效，在julia交互模式输入以下命令</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Pkg</span><br><span class="line"></span><br><span class="line">Pkg.PlatformEngines.probe_platform_engines!()</span><br><span class="line"></span><br><span class="line">Pkg.PlatformEngines.download(<span class="string">&quot;https://github.com/JuliaBinaryWrappers/MKL_jll.jl/releases/download/MKL-v2020.0.166%2B0/MKL.v2020.0.166.x86_64-apple-darwin14.tar.gz&quot;</span>, <span class="string">&quot;MKL_jll.tar.gz&quot;</span>; verbose=<span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>再次运行Pkg.add(“PhyloNetworks”)安装成功。</p>
<h5 id="2、软件使用"><a href="#2、软件使用" class="headerlink" title="2、软件使用"></a>2、软件使用</h5><p>①准备两个文件，一是“多基因树文件” alltree.rooted.txt，用以计算得到CF表，CF表则用于系统发育网络推断的输入；二是“通过astral软件将多基因树整合得到的树” astral.tre，用于构建系统发育网络起点。在Julia的交互模式下</p>
<p>通过多基因树文件制备CF表tableCF.csv</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PhyloNetworks</span><br><span class="line"><span class="keyword">using</span> CSV</span><br><span class="line">iqtrees=joinpath(<span class="string">&quot;alltree.rooted.txt&quot;</span>) <span class="comment">#读取多基因树文件</span></span><br><span class="line">genetrees = readMultiTopology(iqtrees) <span class="comment">#解析基因树</span></span><br><span class="line">q,t = countquartetsintrees(genetrees) <span class="comment">#读取基因树，计算四分类群的CFs</span></span><br><span class="line">df = writeTableCF(q,t) <span class="comment">#读取计算得到的CF值到df：基因频率</span></span><br><span class="line">CSV.write(<span class="string">&quot;tableCF.csv&quot;</span>, df) <span class="comment">#保存df内容为tableCF.csv文件</span></span><br></pre></td></tr></table></figure>

<p>②构建起始网络</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PhyloNetworks </span><br><span class="line">astralfile= joinpath(<span class="string">&quot;astral.tre&quot;</span>) <span class="comment">##读取联合后的基因树文件</span></span><br><span class="line">astraltree = readMultiTopology(astralfile)[<span class="number">1</span>] <span class="comment">#读取文件中的第一棵树</span></span><br><span class="line">CF = readTableCF(<span class="string">&quot;tableCF.csv&quot;</span>) <span class="comment">#读取CF表的数据</span></span><br><span class="line">net0 = snaq!(astraltree,CF, hmax=<span class="number">0</span>, filename=<span class="string">&quot;net0&quot;</span>, seed=<span class="number">1234</span>) <span class="comment">#运行评估程序，We first impose the constraint of at most 0 hybrid node, that is, we ask for a tree</span></span><br></pre></td></tr></table></figure>

<p><strong>最初在运行net0 &#x3D; snaq!(astraltree,CF, hmax&#x3D;0, filename&#x3D;”net0”, seed&#x3D;1234)过程中遇到以下报错</strong></p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">：MethodError: no method matching snaq!(::<span class="built_in">Vector</span>&#123;HybridNetwork&#125;, ::DataCF; hmax=<span class="number">0</span>, filename=<span class="string">&quot;net0&quot;</span>, seed=<span class="number">1234</span>)</span><br></pre></td></tr></table></figure>

<p>原因是读取astralfile树时命令错误，astraltree &#x3D; readMultiTopology(astralfile)，在最末尾没有添加[1]，可能导致数据类型出现问题。当运行astraltree &#x3D; readMultiTopology(astralfile)[1]时，可正常运行。</p>
<p>③把得到的net0作为起点来构建hmax&#x3D;1的网络</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net1 = snaq!(net0, raxmlCF, hmax=<span class="number">1</span>, filename=<span class="string">&quot;net1&quot;</span>, seed=<span class="number">1235</span>) </span><br></pre></td></tr></table></figure>

<p>④迭代运行得到net2、net3……</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net2 = snaq!(net1, raxmlCF, hmax=<span class="number">2</span>, filename=<span class="string">&quot;net2&quot;</span>, seed=<span class="number">1236</span>)</span><br><span class="line">net3 = snaq!(net2, raxmlCF, hmax=<span class="number">2</span>, filename=<span class="string">&quot;net3&quot;</span>, seed=<span class="number">1237</span>)</span><br><span class="line">...... </span><br><span class="line"><span class="comment">#若最佳hmax在5以下，可用此方案</span></span><br></pre></td></tr></table></figure>

<p>另外，如果要运行的h值较多，也可以利用脚本运行，以下脚本未考虑迭代，即每次h值得运行都用同一个起始树astral.tre</p>
<p>当h为1时，设置文件名为runSNaQ_h1.jl，内容如下</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env julia</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># file &quot;runSNaQ.jl&quot;. run in the shell like this in general:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl hvalue nruns</span></span><br><span class="line"><span class="comment"># example for h=2 and default 10 runs:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl 2</span></span><br><span class="line"><span class="comment"># or example for h=3 and 50 runs:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl 3 50</span></span><br><span class="line"></span><br><span class="line">length(<span class="literal">ARGS</span>) &gt; <span class="number">0</span> ||</span><br><span class="line">    error(<span class="string">&quot;need 1 or 2 arguments: # reticulations (h) and # runs (optional, 10 by default)&quot;</span>)</span><br><span class="line">h = parse(<span class="built_in">Int</span>, <span class="literal">ARGS</span>[<span class="number">1</span>])</span><br><span class="line">nruns = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> length(<span class="literal">ARGS</span>) &gt; <span class="number">1</span></span><br><span class="line">    nruns = parse(<span class="built_in">Int</span>, <span class="literal">ARGS</span>[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">outputfile = string(<span class="string">&quot;net&quot;</span>, h, <span class="string">&quot;_&quot;</span>, nruns, <span class="string">&quot;runs&quot;</span>) <span class="comment"># example: &quot;net2_10runs&quot;</span></span><br><span class="line">seed = <span class="number">1234</span> + h <span class="comment"># change as desired! Best to have it different for different h</span></span><br><span class="line"><span class="meta">@info</span> <span class="string">&quot;will run SNaQ with h=<span class="variable">$h</span>, # of runs=<span class="variable">$nruns</span>, seed=<span class="variable">$seed</span>, output will go to: <span class="variable">$outputfile</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Distributed</span><br><span class="line">addprocs(nruns)</span><br><span class="line"><span class="meta">@everywhere</span> <span class="keyword">using</span> PhyloNetworks</span><br><span class="line">net0_h1 = readTopology(<span class="string">&quot;astral.tre&quot;</span>);  <span class="comment">#读取起始树，为了避免并行时linux系统环境变量得区分，在h为1时设置为net0_h1</span></span><br><span class="line"><span class="keyword">using</span> DataFrames, CSV</span><br><span class="line">df_sp = DataFrame(CSV.File(<span class="string">&quot;tableCF.csv&quot;</span>, pool=<span class="literal">false</span>); copycols=<span class="literal">false</span>); <span class="comment">#读取CF表</span></span><br><span class="line">d_sp = readTableCF!(df_sp);</span><br><span class="line">net_h1 = snaq!(net0_h1, d_sp, hmax=h, filename=outputfile, seed=seed, runs=nruns) </span><br></pre></td></tr></table></figure>

<p>当h为2时，设置文件名为runSNaQ_h2.jl，内容如下</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env julia</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># file &quot;runSNaQ.jl&quot;. run in the shell like this in general:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl hvalue nruns</span></span><br><span class="line"><span class="comment"># example for h=2 and default 10 runs:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl 2</span></span><br><span class="line"><span class="comment"># or example for h=3 and 50 runs:</span></span><br><span class="line"><span class="comment"># julia runSNaQ.jl 3 50</span></span><br><span class="line"></span><br><span class="line">length(<span class="literal">ARGS</span>) &gt; <span class="number">0</span> ||</span><br><span class="line">    error(<span class="string">&quot;need 1 or 2 arguments: # reticulations (h) and # runs (optional, 10 by default)&quot;</span>)</span><br><span class="line">h = parse(<span class="built_in">Int</span>, <span class="literal">ARGS</span>[<span class="number">1</span>])</span><br><span class="line">nruns = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> length(<span class="literal">ARGS</span>) &gt; <span class="number">1</span></span><br><span class="line">    nruns = parse(<span class="built_in">Int</span>, <span class="literal">ARGS</span>[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">outputfile = string(<span class="string">&quot;net&quot;</span>, h, <span class="string">&quot;_&quot;</span>, nruns, <span class="string">&quot;runs&quot;</span>) <span class="comment"># example: &quot;net2_10runs&quot;</span></span><br><span class="line">seed = <span class="number">1234</span> + h <span class="comment"># change as desired! Best to have it different for different h</span></span><br><span class="line"><span class="meta">@info</span> <span class="string">&quot;will run SNaQ with h=<span class="variable">$h</span>, # of runs=<span class="variable">$nruns</span>, seed=<span class="variable">$seed</span>, output will go to: <span class="variable">$outputfile</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Distributed</span><br><span class="line">addprocs(nruns)</span><br><span class="line"><span class="meta">@everywhere</span> <span class="keyword">using</span> PhyloNetworks</span><br><span class="line">net0_h2 = readTopology(<span class="string">&quot;astral.tre&quot;</span>);  <span class="comment">#此处net0_h2需要修改</span></span><br><span class="line"><span class="keyword">using</span> DataFrames, CSV</span><br><span class="line">df_sp = DataFrame(CSV.File(<span class="string">&quot;tableCF.csv&quot;</span>, pool=<span class="literal">false</span>); copycols=<span class="literal">false</span>);</span><br><span class="line">d_sp = readTableCF!(df_sp);</span><br><span class="line">net_h2 = snaq!(net0_h2, d_sp, hmax=h, filename=outputfile, seed=seed, runs=nruns) <span class="comment">#此处net0_h2需要修改</span></span><br></pre></td></tr></table></figure>

<p>以此类推，设置h为3、4、5、6…….时得jl文件。</p>
<p>将运行命令写入到同一目录下run_julia.sh文件中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">julia runSNaQ_h1.jl 1  #数字为设置得h值</span><br><span class="line">julia runSNaQ_h2.jl 2</span><br><span class="line">julia runSNaQ_h3.jl 3</span><br><span class="line">julia runSNaQ_h4.jl 4</span><br><span class="line">julia runSNaQ_h5.jl 5</span><br><span class="line">julia runSNaQ_h6.jl 6</span><br><span class="line">julia runSNaQ_h7.jl 7</span><br><span class="line">julia runSNaQ_h8.jl 8</span><br><span class="line">julia runSNaQ_h9.jl 9</span><br><span class="line">julia runSNaQ_h10.jl 10</span><br><span class="line">julia runSNaQ_h11.jl 11</span><br><span class="line">julia runSNaQ_h12.jl 12</span><br></pre></td></tr></table></figure>

<p>利用nohup或screen+ParaFly组合后台运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">screen -S julia</span><br><span class="line">ParaFly -c run_julia.sh -CPU 12</span><br></pre></td></tr></table></figure>

<h5 id="3、结果解读"><a href="#3、结果解读" class="headerlink" title="3、结果解读"></a>3、结果解读</h5><p>①选择最佳系统发育网络</p>
<p><strong>选择运行结果中-loglik值最小的hman值时的运行结果</strong>，将不同h值得-loglik值统计好，可利用excel做折线图。</p>
<p>②可视化，假设h为3时所得的结果为最佳网络树</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PhyloNetworks</span><br><span class="line"><span class="keyword">using</span> PhyloPlots</span><br><span class="line"><span class="keyword">using</span> RCall</span><br><span class="line"></span><br><span class="line">net = readTopology(<span class="string">&quot;net3_10runs.out&quot;</span>)  <span class="comment">#将最佳网络树存为变量net</span></span><br><span class="line">writeTopology(net, <span class="string">&quot;bestnet_h3.tre&quot;</span>) <span class="comment">#将最佳网络树写到bestnet_h3.tre文件</span></span><br><span class="line">rootatnode!(net,<span class="string">&quot;mcap&quot;</span>)  <span class="comment">#对树进行定根</span></span><br><span class="line">imagefilename = <span class="string">&quot;snaqplot_net_root.svg&quot;</span> <span class="comment">#命名</span></span><br><span class="line"><span class="string">R&quot;svg&quot;</span>(imagefilename, width=<span class="number">4</span>, height=<span class="number">3</span>) <span class="comment">#将图片存为svg格式</span></span><br><span class="line"><span class="string">R&quot;par&quot;</span>(mar=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line">plot(net, showgamma=<span class="literal">true</span>, showedgenumber=<span class="literal">true</span>);</span><br><span class="line"><span class="string">R&quot;dev.off()&quot;</span>;  <span class="comment">#将图片存为svg文件</span></span><br></pre></td></tr></table></figure>



<h5 id="二、系统发育网络推断软件PhyloNet的使用（2024-05-29更新）"><a href="#二、系统发育网络推断软件PhyloNet的使用（2024-05-29更新）" class="headerlink" title="二、系统发育网络推断软件PhyloNet的使用（2024.05.29更新）"></a>二、系统发育网络推断软件PhyloNet的使用（2024.05.29更新）</h5><p>该软件官网链接为<a target="_blank" rel="noopener" href="https://phylogenomics.rice.edu/html/phylonetTutorial.html">PhyloNet Tutorial (rice.edu)</a></p>
<p>具体用法参考<a target="_blank" rel="noopener" href="https://wiki.rice.edu/confluence/pages/viewpage.action?pageId=39500205#PhylonetTutorial(SSB2020)-3.BasicUsage">Phylonet Tutorial (SSB 2020) - Phylonet - Rice University Campus Wiki</a></p>
<h5 id="1、下载安装：下载jar文件后，若系统java版本大于等于1-8-0就可以使用"><a href="#1、下载安装：下载jar文件后，若系统java版本大于等于1-8-0就可以使用" class="headerlink" title="1、下载安装：下载jar文件后，若系统java版本大于等于1.8.0就可以使用"></a>1、下载安装：下载jar文件后，若系统java版本大于等于1.8.0就可以使用</h5><h5 id="2、PhyloNet软件使用"><a href="#2、PhyloNet软件使用" class="headerlink" title="2、PhyloNet软件使用"></a>2、PhyloNet软件使用</h5><p>准备一个nex格式文件即可，script.nex包括基因树信息以及程序运行命令，举个栗子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#NEXUS</span></span><br><span class="line"></span><br><span class="line">BEGIN TREES;</span><br><span class="line"></span><br><span class="line">Tree gt0=(a:2.299,((e:1.329,f:1.329):0.77,(c:1.684,(b:1.232,d:1.232):0.451):0.416):0.2);</span><br><span class="line">Tree gt1=(a:2.085,((e:1.376,f:1.376):0.696,(d:1.487,(b:1.241,c:1.241):0.246):0.585):0.013);</span><br><span class="line">Tree gt2=(((c:0.52,d:0.52):1.243,(e:1.403,f:1.403):0.36):1.025,(a:1.863,b:1.863):0.925);</span><br><span class="line">Tree gt3=(a:2.82,((b:1.051,(c:0.86,d:0.86):0.19):1.357,(e:1.365,f:1.365):1.043):0.412);</span><br><span class="line">Tree gt4=((e:1.3,f:1.3):0.994,(a:1.869,(b:1.255,(c:0.849,d:0.849):0.405):0.615):0.425);</span><br><span class="line">Tree gt5=(a:2.46,((b:1.077,c:1.077):0.857,(f:1.141,(d:0.505,e:0.505):0.636):0.793):0.526);</span><br><span class="line">Tree gt6=(a:2.025,((b:1.111,c:1.111):0.416,(f:1.304,(d:0.727,e:0.727):0.577):0.223):0.498);</span><br><span class="line">Tree gt7=((d:1.526,(e:1.415,f:1.415):0.111):0.982,(a:2.188,(b:1.532,c:1.532):0.656):0.32);</span><br><span class="line">Tree gt8=(a:2.234,((b:1.057,c:1.057):0.766,(f:1.301,(d:0.849,e:0.849):0.452):0.522):0.411);</span><br><span class="line">Tree gt9=((e:1.644,(b:1.361,(c:0.503,d:0.503):0.858):0.283):0.787,(a:2.226,f:2.226):0.205);</span><br><span class="line">Tree gt10=(a:2.917,((e:1.683,(c:0.961,d:0.961):0.722):0.886,(b:1.779,f:1.779):0.79):0.348);</span><br><span class="line">Tree gt11=(a:2.391,((b:1.041,(c:0.602,d:0.602):0.439):0.516,(e:1.164,f:1.164):0.393):0.834);</span><br><span class="line">Tree gt12=((b:1.21,c:1.21):1.622,(a:2.443,(f:1.804,(d:0.583,e:0.583):1.221):0.639):0.389);</span><br><span class="line">Tree gt13=(a:2.047,((b:1.025,c:1.025):0.519,(f:1.295,(d:0.738,e:0.738):0.556):0.249):0.503);</span><br><span class="line">Tree gt14=(a:2.58,((d:0.919,e:0.919):0.834,(f:1.503,(b:1.228,c:1.228):0.275):0.251):0.827);</span><br><span class="line">Tree gt15=((f:1.267,(d:0.871,e:0.871):0.396):1.67,(a:2.181,(b:1.362,c:1.362):0.819):0.756);</span><br><span class="line">Tree gt16=(a:3.016,(b:1.892,(c:1.816,(f:1.479,(d:0.812,e:0.812):0.667):0.337):0.076):1.124);</span><br><span class="line">Tree gt17=((f:1.186,(d:0.721,e:0.721):0.465):1.822,(a:2.031,(b:1.13,c:1.13):0.902):0.977);</span><br><span class="line">Tree gt18=((c:1.51,(f:1.166,(d:0.521,e:0.521):0.645):0.345):1.218,(a:2.073,b:2.073):0.655);</span><br><span class="line">Tree gt19=(a:2.329,((b:1.354,c:1.354):0.467,(f:1.392,(d:0.955,e:0.955):0.437):0.429):0.508);</span><br><span class="line">Tree gt20=(a:3.31,((e:1.083,f:1.083):2.08,(b:1.923,(c:0.538,d:0.538):1.385):1.241):0.146);</span><br><span class="line"></span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BEGIN PHYLONET;</span><br><span class="line"></span><br><span class="line">InferNetwork_MPL (all) 2 -pl 8;</span><br><span class="line"></span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>①要准备script.nex文件，需要以下几步：a.对已有的多个序列分别进行比对、剪切、构树，可以参考<a href="https://wu-tz.github.io/2021/12/26/pipeline-of-phylogeny/">test_pipeline-of-phylogeny | TianzhenWu’ Blog (wu-tz.github.io)</a>。b. 获取多个treefile后，分别对他们进行定根处理，可以参考<a href="https://wu-tz.github.io/2023/10/05/%E5%88%A9%E7%94%A8ete3%E6%89%B9%E9%87%8F%E5%AF%B9%E5%9F%BA%E5%9B%A0%E6%A0%91%E5%AE%9A%E6%A0%B9/">利用ete3批量对基因树定根并检测单系性 | TianzhenWu’ Blog (wu-tz.github.io)</a>。c. 将所有treefile放到一个文件中，利用shell命令补全每一行的前缀“Tree gt1&#x3D;”。d. 手动补全nexus格式文件的开始和结尾。e. 在文件末尾补充PHYLONET程序的参数，方法的选择参考<a target="_blank" rel="noopener" href="https://phylogenomics.rice.edu/html/phylonetTutorial.html%E3%80%82">https://phylogenomics.rice.edu/html/phylonetTutorial.html。</a></p>
<p>②运行命令如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar PhyloNetv3_8_2.jar script.nex</span><br></pre></td></tr></table></figure>

<h5 id="3、PhyloNet结果解读"><a href="#3、PhyloNet结果解读" class="headerlink" title="3、PhyloNet结果解读"></a>3、PhyloNet结果解读</h5><p>每次运行输出5个可能的进化网络树，分别对应着统计量Total log probability，该值越大越可靠。</p>
<h5 id="4、-Visualizing-a-Phylogenetic-Network"><a href="#4、-Visualizing-a-Phylogenetic-Network" class="headerlink" title="4、 Visualizing a Phylogenetic Network"></a>4、 Visualizing a Phylogenetic Network</h5><p>Phylogenetic network in Rich Newick string can be visualized in <a target="_blank" rel="noopener" href="http://ab.inf.uni-tuebingen.de/software/dendroscope/">Dendroscope</a> or <a target="_blank" rel="noopener" href="https://icytree.org/">icytree</a>. The former needs downloading, and the latter is online. However, Dendroscope cannot recognize inheritance probabilities (branch lengths are fine), and icytree sometimes can and sometimes cannot. You need to remove those probabilities manually from the Rich Newick string, or use option “-di” so that PhyloNet returns the network that Dendroscope takes directly. 此处参考<a target="_blank" rel="noopener" href="https://wiki.rice.edu/confluence/pages/viewpage.action?pageId=39500205#PhylonetTutorial(SSB2020)-3.BasicUsage">https://wiki.rice.edu/confluence/pages/viewpage.action?pageId=39500205#PhylonetTutorial(SSB2020)-3.BasicUsage</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wu-tz.github.io">吴 田 振</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wu-tz.github.io/2023/10/07/phylonetwork/">https://wu-tz.github.io/2023/10/07/phylonetwork/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wu-tz.github.io" target="_blank">TianzhenWu' Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PhyloNetworks/">PhyloNetworks</a></div><div class="post_share"><div class="social-share" data-image="/2023/10/07/phylonetwork/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/20/%E6%BA%AF%E7%A5%96%E6%A0%91%E4%B8%8E%E5%9F%BA%E5%9B%A0%E6%A0%91%E4%B9%8B%E9%97%B4%E5%86%B2%E7%AA%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96/" title="溯祖树与基因树之间冲突的可视化"><img class="cover" src="/2024/01/20/%E6%BA%AF%E7%A5%96%E6%A0%91%E4%B8%8E%E5%9F%BA%E5%9B%A0%E6%A0%91%E4%B9%8B%E9%97%B4%E5%86%B2%E7%AA%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96/1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">溯祖树与基因树之间冲突的可视化</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/05/%E5%88%A9%E7%94%A8ete3%E6%89%B9%E9%87%8F%E5%AF%B9%E5%9F%BA%E5%9B%A0%E6%A0%91%E5%AE%9A%E6%A0%B9/" title="利用ete3批量对基因树定根并检测单系性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">利用ete3批量对基因树定根并检测单系性</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/orca-295051_1280.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">吴 田 振</div><div class="author-info__description">努力发一区</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" href="https://wu-tz.github.io/"><i class="iconfont icon-CSDN"></i><span>收藏我啊</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wu-tz" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wtzsdut@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=2312164805&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">在这里记录的是一些随笔，包括文件处理技巧、软件使用、生物知识等，作为我的工作以及生活记录。欢迎您的访问，祝工作顺利！喜欢的话欢迎收藏~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%B3%BB%E7%BB%9F%E5%8F%91%E8%82%B2%E7%BD%91%E7%BB%9C%E6%8E%A8%E6%96%AD%E8%BD%AF%E4%BB%B6PhyloNetworks%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B%E4%BB%A5%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%8A%A5%E9%94%99"><span class="toc-number">1.</span> <span class="toc-text">一、系统发育网络推断软件PhyloNetworks的使用流程以及解决报错</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">1、安装</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">2、软件使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%BB%93%E6%9E%9C%E8%A7%A3%E8%AF%BB"><span class="toc-number">4.</span> <span class="toc-text">3、结果解读</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%B3%BB%E7%BB%9F%E5%8F%91%E8%82%B2%E7%BD%91%E7%BB%9C%E6%8E%A8%E6%96%AD%E8%BD%AF%E4%BB%B6PhyloNet%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%882024-05-29%E6%9B%B4%E6%96%B0%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">二、系统发育网络推断软件PhyloNet的使用（2024.05.29更新）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%EF%BC%9A%E4%B8%8B%E8%BD%BDjar%E6%96%87%E4%BB%B6%E5%90%8E%EF%BC%8C%E8%8B%A5%E7%B3%BB%E7%BB%9Fjava%E7%89%88%E6%9C%AC%E5%A4%A7%E4%BA%8E%E7%AD%89%E4%BA%8E1-8-0%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">1、下载安装：下载jar文件后，若系统java版本大于等于1.8.0就可以使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81PhyloNet%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">2、PhyloNet软件使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81PhyloNet%E7%BB%93%E6%9E%9C%E8%A7%A3%E8%AF%BB"><span class="toc-number">8.</span> <span class="toc-text">3、PhyloNet结果解读</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81-Visualizing-a-Phylogenetic-Network"><span class="toc-number">9.</span> <span class="toc-text">4、 Visualizing a Phylogenetic Network</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/17/genome-anno/" title="genome_anno">genome_anno</a><time datetime="2024-07-17T13:06:54.000Z" title="发表于 2024-07-17 21:06:54">2024-07-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/09/QuIBL%E6%96%B9%E6%B3%95%E6%A3%80%E9%AA%8C%E5%9F%BA%E5%9B%A0%E6%B8%90%E6%B8%97%E5%92%8C%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%B0%B1%E7%B3%BB%E5%88%86%E9%80%89/" title="QuIBL方法检验基因渐渗和不完全谱系分选"><img src="/2024/04/09/QuIBL%E6%96%B9%E6%B3%95%E6%A3%80%E9%AA%8C%E5%9F%BA%E5%9B%A0%E6%B8%90%E6%B8%97%E5%92%8C%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%B0%B1%E7%B3%BB%E5%88%86%E9%80%89/2024-04-09%20154337.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="QuIBL方法检验基因渐渗和不完全谱系分选"/></a><div class="content"><a class="title" href="/2024/04/09/QuIBL%E6%96%B9%E6%B3%95%E6%A3%80%E9%AA%8C%E5%9F%BA%E5%9B%A0%E6%B8%90%E6%B8%97%E5%92%8C%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%B0%B1%E7%B3%BB%E5%88%86%E9%80%89/" title="QuIBL方法检验基因渐渗和不完全谱系分选">QuIBL方法检验基因渐渗和不完全谱系分选</a><time datetime="2024-04-09T07:30:28.000Z" title="发表于 2024-04-09 15:30:28">2024-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/20/%E6%BA%AF%E7%A5%96%E6%A0%91%E4%B8%8E%E5%9F%BA%E5%9B%A0%E6%A0%91%E4%B9%8B%E9%97%B4%E5%86%B2%E7%AA%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96/" title="溯祖树与基因树之间冲突的可视化"><img src="/2024/01/20/%E6%BA%AF%E7%A5%96%E6%A0%91%E4%B8%8E%E5%9F%BA%E5%9B%A0%E6%A0%91%E4%B9%8B%E9%97%B4%E5%86%B2%E7%AA%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="溯祖树与基因树之间冲突的可视化"/></a><div class="content"><a class="title" href="/2024/01/20/%E6%BA%AF%E7%A5%96%E6%A0%91%E4%B8%8E%E5%9F%BA%E5%9B%A0%E6%A0%91%E4%B9%8B%E9%97%B4%E5%86%B2%E7%AA%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96/" title="溯祖树与基因树之间冲突的可视化">溯祖树与基因树之间冲突的可视化</a><time datetime="2024-01-20T11:21:18.000Z" title="发表于 2024-01-20 19:21:18">2024-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/07/phylonetwork/" title="系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error"><img src="/2023/10/07/phylonetwork/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error"/></a><div class="content"><a class="title" href="/2023/10/07/phylonetwork/" title="系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error">系统发育网络推断软件PhyloNetworks和Phylonet的使用及遇到的error</a><time datetime="2023-10-07T08:07:46.000Z" title="发表于 2023-10-07 16:07:46">2023-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/05/%E5%88%A9%E7%94%A8ete3%E6%89%B9%E9%87%8F%E5%AF%B9%E5%9F%BA%E5%9B%A0%E6%A0%91%E5%AE%9A%E6%A0%B9/" title="利用ete3批量对基因树定根并检测单系性">利用ete3批量对基因树定根并检测单系性</a><time datetime="2023-10-05T13:48:42.000Z" title="发表于 2023-10-05 21:48:42">2023-10-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 吴 田 振</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'df0416f2a2a671d6598e',
      clientSecret: '467cfdeb21916756ac8cc1a57004fd876bca7549',
      repo: 'Wu-tz.github.io',
      owner: 'Wu-tz',
      admin: ['Wu-tz'],
      id: '82946a76fafea66c3b15938742623eb0',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.textContent= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>